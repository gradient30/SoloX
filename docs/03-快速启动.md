# å¿«é€Ÿå¯åŠ¨æŒ‡å—

## ğŸ“‹ ç¯å¢ƒè¦æ±‚

### ç³»ç»Ÿè¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: Windows 10+, macOS 10.14+, Ubuntu 18.04+
- **Python**: 3.10 æˆ–æ›´é«˜ç‰ˆæœ¬
- **å†…å­˜**: æœ€å°‘ 4GB RAM
- **å­˜å‚¨**: è‡³å°‘ 1GB å¯ç”¨ç©ºé—´

### å¿…éœ€å·¥å…·

#### 1. Python ç¯å¢ƒ
```bash
# æ£€æŸ¥ Python ç‰ˆæœ¬
python --version
# æˆ–
python3 --version

# å¦‚æœç‰ˆæœ¬ä½äº 3.10ï¼Œè¯·ä»å®˜ç½‘ä¸‹è½½æœ€æ–°ç‰ˆæœ¬
# https://www.python.org/downloads/
```

#### 2. ADB å·¥å…· (Android æµ‹è¯•å¿…éœ€)
```bash
# ä¸‹è½½ Android Platform Tools
# https://developer.android.com/studio/releases/platform-tools

# é…ç½®ç¯å¢ƒå˜é‡ (Windows)
# å°† platform-tools ç›®å½•æ·»åŠ åˆ° PATH

# éªŒè¯å®‰è£…
adb version
```

#### 3. iTunes (iOS æµ‹è¯•ï¼Œä»… Windows)
```bash
# Windows ç”¨æˆ·æµ‹è¯• iOS è®¾å¤‡éœ€è¦å®‰è£… iTunes
# https://www.apple.com/itunes/download/
# æ³¨æ„: ä¸æ”¯æŒ iOS 17
```

## ğŸš€ å®‰è£…æ­¥éª¤

### æ–¹æ³•ä¸€: PyPI å®‰è£… (æ¨è)

```bash
# å®‰è£…æœ€æ–°ç‰ˆæœ¬
pip install -U solox

# å®‰è£…æŒ‡å®šç‰ˆæœ¬
pip install solox==2.9.3

# ä½¿ç”¨å›½å†…é•œåƒ (ç½‘ç»œè¾ƒæ…¢æ—¶)
pip install -i https://mirrors.ustc.edu.cn/pypi/web/simple -U solox
```

### æ–¹æ³•äºŒ: æºç å®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/smart-test-ti/SoloX.git
cd SoloX

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å®‰è£…é¡¹ç›®
pip install -e .
```

### æ–¹æ³•ä¸‰: æ‰‹åŠ¨å®‰è£…ä¾èµ– (æ¨èç”¨äºå¼€å‘ç¯å¢ƒ)

å¦‚æœé‡åˆ°æƒé™é—®é¢˜æˆ–ç‰ˆæœ¬å†²çªï¼Œå¯ä»¥æ‰‹åŠ¨å®‰è£…å…¼å®¹çš„ä¾èµ–ç‰ˆæœ¬ï¼š

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/smart-test-ti/SoloX.git
cd SoloX

# å®‰è£…æ ¸å¿ƒä¾èµ– (ä½¿ç”¨ç”¨æˆ·çº§å®‰è£…é¿å…æƒé™é—®é¢˜)
pip install --user fire logzero

# å®‰è£… Web æ¡†æ¶ä¾èµ– (æŒ‡å®šå…¼å®¹ç‰ˆæœ¬)
pip install --user Flask==2.0.3 Werkzeug==2.0.3
pip install --user Flask-SocketIO==4.3.1 python-socketio==4.6.0 python-engineio==3.13.2

# å®‰è£…è®¾å¤‡é€šä¿¡ä¾èµ–
pip install --user tidevice==0.9.7

# å®‰è£…å…¶ä»–ä¾èµ–
pip install --user pyfiglet psutil opencv-python

# éªŒè¯å®‰è£…
python -c "import solox; print('SoloX å®‰è£…æˆåŠŸ')"
```

### æ–¹æ³•ä¸‰: å¼€å‘ç¯å¢ƒå®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/smart-test-ti/SoloX.git
cd SoloX

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
# Windows
venv\Scripts\activate
# macOS/Linux
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

## ğŸ¯ å¯åŠ¨æœåŠ¡

### é»˜è®¤å¯åŠ¨

```bash
# ä½¿ç”¨é»˜è®¤é…ç½®å¯åŠ¨
python -m solox

# æœåŠ¡å°†åœ¨ä»¥ä¸‹åœ°å€å¯åŠ¨:
# http://localhost:50003/?platform=Android&lan=en
```

### è‡ªå®šä¹‰é…ç½®å¯åŠ¨

```bash
# æŒ‡å®š IP å’Œç«¯å£
python -m solox --host=0.0.0.0 --port=8080

# è®¿é—®åœ°å€:
# http://0.0.0.0:8080/?platform=Android&lan=en
```

### åå°æœåŠ¡å¯åŠ¨

```bash
# macOS/Linux
nohup python3 -m solox &

# Windows
start /min python3 -m solox &
```

## ğŸ“± è®¾å¤‡è¿æ¥

### Android è®¾å¤‡

1. **å¼€å¯å¼€å‘è€…é€‰é¡¹**
   - è®¾ç½® â†’ å…³äºæ‰‹æœº â†’ è¿ç»­ç‚¹å‡»ç‰ˆæœ¬å· 7 æ¬¡

2. **å¼€å¯ USB è°ƒè¯•**
   - è®¾ç½® â†’ å¼€å‘è€…é€‰é¡¹ â†’ USB è°ƒè¯•

3. **è¿æ¥è®¾å¤‡**
   ```bash
   # æ£€æŸ¥è®¾å¤‡è¿æ¥
   adb devices
   
   # åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡º:
   # List of devices attached
   # ca6bd5a5    device
   ```

4. **æˆæƒè°ƒè¯•**
   - é¦–æ¬¡è¿æ¥ä¼šå¼¹å‡ºæˆæƒå¯¹è¯æ¡†ï¼Œç‚¹å‡»"ç¡®å®š"

### iOS è®¾å¤‡

1. **å®‰è£…ä¾èµ–** (macOS)
   ```bash
   # å®‰è£… libimobiledevice
   brew install libimobiledevice
   
   # å®‰è£… tidevice
   pip install tidevice
   ```

2. **è¿æ¥è®¾å¤‡**
   ```bash
   # æ£€æŸ¥è®¾å¤‡è¿æ¥
   tidevice list
   
   # åº”è¯¥çœ‹åˆ°è®¾å¤‡ä¿¡æ¯
   ```

3. **ä¿¡ä»»ç”µè„‘**
   - è¿æ¥æ—¶é€‰æ‹©"ä¿¡ä»»æ­¤ç”µè„‘"

## ğŸŒ Web ç•Œé¢ä½¿ç”¨

### 1. è®¿é—®ç•Œé¢

æ‰“å¼€æµè§ˆå™¨è®¿é—®: `http://localhost:50003`

### 2. é€‰æ‹©å¹³å°

- **Android**: é€‰æ‹© Android å¹³å°è¿›è¡Œæµ‹è¯•
- **iOS**: é€‰æ‹© iOS å¹³å°è¿›è¡Œæµ‹è¯•

### 3. é€‰æ‹©è®¾å¤‡

- åœ¨è®¾å¤‡åˆ—è¡¨ä¸­é€‰æ‹©è¦æµ‹è¯•çš„è®¾å¤‡
- ç¡®ä¿è®¾å¤‡å·²æ­£ç¡®è¿æ¥å¹¶æˆæƒ

### 4. é€‰æ‹©åº”ç”¨

- è¾“å…¥åº”ç”¨åŒ…å (å¦‚: `com.example.app`)
- æˆ–ä»å·²å®‰è£…åº”ç”¨åˆ—è¡¨ä¸­é€‰æ‹©

### 5. é…ç½®ç›‘æ§å‚æ•°

```javascript
// ç›‘æ§é…ç½®ç¤ºä¾‹
{
  "duration": 60,           // ç›‘æ§æ—¶é•¿ (ç§’)
  "cpuWarning": 80,        // CPU å‘Šè­¦é˜ˆå€¼ (%)
  "memoryWarning": 1024,   // å†…å­˜å‘Šè­¦é˜ˆå€¼ (MB)
  "fpsWarning": 30,        // FPS å‘Šè­¦é˜ˆå€¼
  "batteryWarning": 20,    // ç”µæ± å‘Šè­¦é˜ˆå€¼ (%)
  "gpuWarning": 80         // GPU å‘Šè­¦é˜ˆå€¼ (%)
}
```

### 6. å¼€å§‹ç›‘æ§

ç‚¹å‡»"å¼€å§‹ç›‘æ§"æŒ‰é’®ï¼Œç³»ç»Ÿå°†å¼€å§‹æ”¶é›†æ€§èƒ½æ•°æ®å¹¶å®æ—¶å±•ç¤ºã€‚

## ğŸ”§ å‘½ä»¤è¡Œä½¿ç”¨

### åŸºæœ¬å‘½ä»¤

```bash
# æŸ¥çœ‹å¸®åŠ©
python -m solox --help

# å¯åŠ¨æœåŠ¡
python -m solox

# æŒ‡å®šé…ç½®
python -m solox --host=192.168.1.100 --port=8080
```

### å¼€å‘è°ƒè¯•æ¨¡å¼

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd solox

# å¯åŠ¨è°ƒè¯•æ¨¡å¼
python debug.py
```

## ğŸ Python API ä½¿ç”¨

### åŸºæœ¬ä½¿ç”¨

```python
from solox.public.apm import AppPerformanceMonitor
from solox.public.common import Devices

# è·å–è®¾å¤‡ä¿¡æ¯
d = Devices()
devices = d.getDeviceIds()
print(f"è¿æ¥çš„è®¾å¤‡: {devices}")

# è·å–åº”ç”¨è¿›ç¨‹
processList = d.getPid(deviceId='ca6bd5a5', pkgName='com.example.app')
print(f"åº”ç”¨è¿›ç¨‹: {processList}")

# åˆ›å»ºæ€§èƒ½ç›‘æ§å®ä¾‹
apm = AppPerformanceMonitor(
    pkgName='com.example.app',
    platform='Android',
    deviceId='ca6bd5a5',
    surfaceview=True,
    noLog=False,
    duration=60
)

# æ”¶é›†å•é¡¹æ€§èƒ½æ•°æ®
cpu = apm.collectCpu()          # CPU ä½¿ç”¨ç‡
memory = apm.collectMemory()    # å†…å­˜ä½¿ç”¨
network = apm.collectNetwork()  # ç½‘ç»œæµé‡
fps = apm.collectFps()          # FPS å¸§ç‡
battery = apm.collectBattery()  # ç”µæ± ä¿¡æ¯

print(f"CPU: {cpu}%")
print(f"å†…å­˜: {memory}MB")
print(f"ç½‘ç»œ: {network}KB")
print(f"FPS: {fps}Hz")
print(f"ç”µæ± : {battery}")
```

### å…¨é‡ç›‘æ§

```python
# å…¨é‡æ€§èƒ½ç›‘æ§
apm = AppPerformanceMonitor(
    pkgName='com.example.app',
    platform='Android',
    deviceId='ca6bd5a5',
    collect_all=True,
    duration=300,  # ç›‘æ§ 5 åˆ†é’Ÿ
    record=True    # åŒæ—¶å½•åˆ¶å±å¹•
)

# å¼€å§‹ç›‘æ§å¹¶ç”ŸæˆæŠ¥å‘Š
apm.collectAll(report_path='/path/to/report.html')
```

## ğŸ” éªŒè¯å®‰è£…

### 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€

```bash
# è®¿é—®å¥åº·æ£€æŸ¥æ¥å£
curl http://localhost:50003/health

# é¢„æœŸè¿”å›: {"status": "ok"}
```

### 2. æ£€æŸ¥è®¾å¤‡è¿æ¥

```bash
# Android
adb devices

# iOS
tidevice list
```

### 3. æµ‹è¯• API

```bash
# æµ‹è¯• CPU ç›‘æ§ API
curl "http://localhost:50003/apm/collect?platform=Android&deviceid=ca6bd5a5&pkgname=com.example.app&target=cpu"
```

## â— å¸¸è§é—®é¢˜

### 1. ç«¯å£è¢«å ç”¨

```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
netstat -ano | findstr :50003

# æ€æ­»å ç”¨è¿›ç¨‹ (Windows)
taskkill /PID <PID> /F

# æˆ–ä½¿ç”¨å…¶ä»–ç«¯å£
python -m solox --port=50004
```

### 2. è®¾å¤‡è¿æ¥å¤±è´¥

```bash
# é‡å¯ ADB æœåŠ¡
adb kill-server
adb start-server

# æ£€æŸ¥è®¾å¤‡æˆæƒ
adb devices
```

### 3. ä¾èµ–å®‰è£…å¤±è´¥

```bash
# å‡çº§ pip
pip install --upgrade pip

# ä½¿ç”¨å›½å†…é•œåƒ
pip install -i https://mirrors.aliyun.com/pypi/simple/ solox

# å¦‚æœé‡åˆ°æƒé™é—®é¢˜ï¼Œä½¿ç”¨ç”¨æˆ·çº§å®‰è£…
pip install --user solox

# å¦‚æœé‡åˆ°ç‰ˆæœ¬å†²çªï¼Œæ‰‹åŠ¨å®‰è£…å…¼å®¹ç‰ˆæœ¬
pip install --user Flask==2.0.3 Werkzeug==2.0.3 Flask-SocketIO==4.3.1
```

### 4. ç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜

**å¸¸è§é”™è¯¯**: `ImportError: cannot import name 'url_quote' from 'werkzeug.urls'`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# å®‰è£…å…¼å®¹çš„ Flask å’Œ Werkzeug ç‰ˆæœ¬
pip install --user Flask==2.0.3 Werkzeug==2.0.3

# å®‰è£…å…¼å®¹çš„ Flask-SocketIO ç‰ˆæœ¬
pip install --user Flask-SocketIO==4.3.1 python-socketio==4.6.0 python-engineio==3.13.2
```

**å¸¸è§é”™è¯¯**: `ModuleNotFoundError: No module named 'fire'`

**è§£å†³æ–¹æ¡ˆ**:
```bash
# å®‰è£…ç¼ºå¤±çš„ä¾èµ–
pip install --user fire pyfiglet psutil opencv-python tidevice==0.9.7
```

### 5. å®Œæ•´ä¾èµ–å®‰è£…è„šæœ¬

å¦‚æœé‡åˆ°å¤šä¸ªä¾èµ–é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å®Œæ•´è„šæœ¬ï¼š

```bash
#!/bin/bash
# install_solox_deps.sh - SoloX ä¾èµ–å®‰è£…è„šæœ¬

echo "å¼€å§‹å®‰è£… SoloX ä¾èµ–..."

# æ ¸å¿ƒä¾èµ–
pip install --user fire logzero

# Web æ¡†æ¶ä¾èµ– (æŒ‡å®šå…¼å®¹ç‰ˆæœ¬)
pip install --user Flask==2.0.3 Werkzeug==2.0.3
pip install --user Flask-SocketIO==4.3.1 python-socketio==4.6.0 python-engineio==3.13.2

# è®¾å¤‡é€šä¿¡ä¾èµ–
pip install --user tidevice==0.9.7

# å…¶ä»–ä¾èµ–
pip install --user pyfiglet psutil opencv-python

echo "ä¾èµ–å®‰è£…å®Œæˆï¼"
echo "éªŒè¯å®‰è£…..."
python -c "import solox; print('âœ… SoloX å®‰è£…æˆåŠŸ')" || echo "âŒ å®‰è£…éªŒè¯å¤±è´¥"
```

**Windows ç”¨æˆ·ä½¿ç”¨ PowerShell è„šæœ¬**:
```powershell
# install_solox_deps.ps1
Write-Host "å¼€å§‹å®‰è£… SoloX ä¾èµ–..." -ForegroundColor Green

# æ ¸å¿ƒä¾èµ–
pip install --user fire logzero

# Web æ¡†æ¶ä¾èµ–
pip install --user Flask==2.0.3 Werkzeug==2.0.3
pip install --user Flask-SocketIO==4.3.1 python-socketio==4.6.0 python-engineio==3.13.2

# è®¾å¤‡é€šä¿¡ä¾èµ–
pip install --user tidevice==0.9.7

# å…¶ä»–ä¾èµ–
pip install --user pyfiglet psutil opencv-python

Write-Host "ä¾èµ–å®‰è£…å®Œæˆï¼" -ForegroundColor Green
python -c "import solox; print('âœ… SoloX å®‰è£…æˆåŠŸ')"
```

---

*ä¸‹ä¸€æ­¥: [å¼€å‘æŒ‡å—](./04-å¼€å‘æŒ‡å—.md)*
